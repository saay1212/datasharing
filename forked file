This is the forked file for my project, make the coding more efficient and clear.
